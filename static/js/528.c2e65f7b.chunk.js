"use strict";(self.webpackChunkcode_portfolio=self.webpackChunkcode_portfolio||[]).push([[528],{528:(e,t,r)=>{r.r(t),r.d(t,{default:()=>u});var n=r(9379),s=r(5043),a=r(3216),i=r(9722),o=r(8745);const c="".concat("https://devportfolio20240614070249.azurewebsites.net/api"),l={headers:{"content-type":"application/json"},crossDomain:!0};r(7220);var d=r(579);const u=()=>{const[e,t]=(0,s.useState)([]),[r,u]=(0,s.useState)(""),[v,w]=(0,s.useState)([]),[h,g]=(0,s.useState)(null),[f,m]=(0,s.useState)([]),[_,x]=(0,s.useState)(!1),[p,y]=(0,s.useState)(!1),[b,j]=(0,s.useState)(null),{state:E}=(0,a.zy)(),N=(0,s.useMemo)(()=>f.length>0&&0===v.length&&!h,[v,h,f]),k=(0,s.useRef)(null),q=(0,s.useCallback)(()=>{x(!0);let e=f.reduce((e,t)=>e+t.grade,0);e/=f.length,setTimeout(()=>{t(t=>[...t,{sender:"ai",text:"Your final grade is: ".concat(e)}]),x(!1),y(!0)},1e3)},[f]),S=async e=>{try{var r;x(!0);const s={question:h.question,answer:e},a=await(async e=>{const t=(0,n.A)({method:"POST",data:e,url:"".concat(c,"/InterviewGrading/create")},l);try{const e=(0,i.A)(t);if(!e)throw new Error("No response from requestInterviewGrading");return e}catch(r){Promise.reject(r)}})(s);if(null===a||void 0===a||!a.data)throw new Error("Error sending grading request");const d=await(async e=>{let t,r=0,s=Math.floor(4);const a=(0,n.A)({method:"GET",url:"".concat(c,"/InterviewGrading/").concat(e)},l),d=async(e,n)=>{let c;r++;try{r%3===0&&o.oR.info("Still working on this for you..."),c=await(0,i.A)(a),clearInterval(t),e(c)}catch(l){(r>=s||404!==l.response.status)&&(clearInterval(t),n(l))}};return new Promise((e,r)=>{t=setInterval(d,1e3,e,r)})})(a.data);if(null===d||void 0===d||null===(r=d.data)||void 0===r||!r.gradingResult)throw new Error("Error getting grading results");m(e=>[...e,d.data.gradingResult]),t(e=>[...e,{sender:"ai",text:"".concat(d.data.gradingResult.feedback)}]),x(!1),(()=>{if(v.length){const e=v.pop();x(!0),setTimeout(()=>{t(t=>[...t,{sender:"ai",text:"Next question: ".concat(e.question)}]),g(e),x(!1)},1e3)}else g(null)})()}catch(s){t(e=>[...e,{sender:"ai",text:"I had difficulties analyzing your response, please re-send it."}]),x(!1)}},I=n=>{var s,a;if(n.shiftKey&&"Enter"===n.key){n.preventDefault();var i=n.target.selectionStart,o=n.target.selectionEnd,c=n.target.value;n.target.value=c.substring(0,i)+"\n"+c.substring(o),n.target.selectionStart=n.target.selectionEnd=i+1}if("Enter"===n.key&&!n.shiftKey||"1"===(null===(s=n.currentTarget)||void 0===s||null===(a=s.dataset)||void 0===a?void 0:a.send)){n.preventDefault();const s=r.trim();s.replace(/(\r\n|\n|\r)+/gm,"").trim().length>0&&(t([...e,{sender:"user",text:s}]),S(s),u(""))}},T=(0,s.useCallback)(e=>{t(e=>[...e,{sender:"ai",text:"Welcome to the ".concat(b.text," interview. During this session, I will ask you five technical questions. Please respond to each question to the best of your ability. At the end of the interview, I will provide you with your final grade. Let's get started with the first question:")}]),x(!0),setTimeout(()=>{t(t=>[...t,{sender:"ai",text:"".concat(e.question)}]),g(e),x(!1)},2e3)},[b]),A=(0,s.useCallback)(async()=>{try{if(null!==b&&void 0!==b&&b.id){x(!0);const e=await(async e=>{const t=(0,n.A)({method:"GET",url:"".concat(c,"/InterviewQuestions/").concat(e)},l);try{const e=(0,i.A)(t);if(!e)throw new Error("No response from requestInterviewGrading");return e}catch(r){Promise.reject(r)}})(b.id),t=e.data;if(null===t||void 0===t||!t.length)throw new Error("No questions found.");const r=t.pop();x(!1),T(r),w(t)}}catch(e){x(!1),o.oR.error("Error fetching interview questions. Please try again")}},[b,T]);return(0,s.useEffect)(()=>{A()},[A]),(0,s.useEffect)(()=>{j((0,n.A)({},E))},[E]),(0,s.useEffect)(()=>{N&&q()},[q,N]),(0,s.useEffect)(()=>{k.current&&(k.current.scrollTop=k.current.scrollHeight)},[e]),(0,d.jsxs)("div",{className:"new-interview__root",children:[(0,d.jsxs)("h1",{className:"new-interview__header",children:[null===b||void 0===b?void 0:b.text," Interview"]}),(0,d.jsxs)("div",{className:"new-interview__chatbox-container",children:[" ",(0,d.jsxs)("div",{className:"new-interview__chatbox",ref:k,children:[e.map((e,t)=>(0,d.jsx)("div",{className:"new-interview__message new-interview__message--".concat(e.sender),children:(0,d.jsx)("div",{className:"new-interview__message-box new-interview__message-box--".concat(e.sender),children:e.text})},t)),_&&(0,d.jsx)("div",{className:"react-interview__message react-interview__message--ai",children:(0,d.jsx)("div",{className:"react-interview__loader",children:(0,d.jsxs)("div",{className:"react-interview__loader-dots",children:[(0,d.jsx)("div",{className:"react-interview__loader-dot"}),(0,d.jsx)("div",{className:"react-interview__loader-dot"}),(0,d.jsx)("div",{className:"react-interview__loader-dot"})]})})})]}),(0,d.jsxs)("div",{className:"new-interview__input",children:[(0,d.jsx)("textarea",{value:r,onChange:e=>{u(e.target.value)},onKeyDown:I,rows:"3",placeholder:"Type your answer...",disabled:_||p,autoCorrect:"on"}),(0,d.jsx)("button",{onClick:I,"data-send":"1",disabled:_||p,children:"Send"})]})]})]})}},7220:()=>{}}]);
//# sourceMappingURL=528.c2e65f7b.chunk.js.map