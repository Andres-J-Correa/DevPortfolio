"use strict";(self.webpackChunkcode_portfolio=self.webpackChunkcode_portfolio||[]).push([[528],{528:(e,t,r)=>{r.r(t),r.d(t,{default:()=>d});var a=r(43),n=r(216),s=r(213),i=r(745);const o="".concat("https://devportfolio20240614070249.azurewebsites.net/api"),c={headers:{"content-type":"application/json"},crossDomain:!0};r(220);var l=r(579);const d=()=>{const[e,t]=(0,a.useState)([]),[r,d]=(0,a.useState)(""),[u,v]=(0,a.useState)([]),[w,h]=(0,a.useState)(null),[g,f]=(0,a.useState)([]),[m,_]=(0,a.useState)(!1),[x,p]=(0,a.useState)(!1),[y,b]=(0,a.useState)(null),{state:j}=(0,n.zy)(),E=(0,a.useMemo)((()=>g.length>0&&0===u.length&&!w),[u,w,g]),N=(0,a.useRef)(null),k=(0,a.useCallback)((()=>{_(!0);let e=g.reduce(((e,t)=>e+t.grade),0);e/=g.length,setTimeout((()=>{t((t=>[...t,{sender:"ai",text:"Your final grade is: ".concat(e)}])),_(!1),p(!0)}),1e3)}),[g]),S=async e=>{try{var r;_(!0);const a={question:w.question,answer:e},n=await(async e=>{const t={method:"POST",data:e,url:"".concat(o,"/InterviewGrading/create"),...c};try{const e=(0,s.A)(t);if(!e)throw new Error("No response from requestInterviewGrading");return e}catch(r){Promise.reject(r)}})(a);if(null===n||void 0===n||!n.data)throw new Error("Error sending grading request");const l=await(async e=>{let t,r=0,a=Math.floor(4);const n={method:"GET",url:"".concat(o,"/InterviewGrading/").concat(e),...c},l=async(e,o)=>{let c;r++;try{r%3===0&&i.oR.info("Still working on this for you..."),c=await(0,s.A)(n),clearInterval(t),e(c)}catch(l){(r>=a||404!==l.response.status)&&(clearInterval(t),o(l))}};return new Promise(((e,r)=>{t=setInterval(l,1e3,e,r)}))})(n.data);if(null===l||void 0===l||null===(r=l.data)||void 0===r||!r.gradingResult)throw new Error("Error getting grading results");f((e=>[...e,l.data.gradingResult])),t((e=>[...e,{sender:"ai",text:"".concat(l.data.gradingResult.feedback)}])),_(!1),(()=>{if(u.length){const e=u.pop();_(!0),setTimeout((()=>{t((t=>[...t,{sender:"ai",text:"Next question: ".concat(e.question)}])),h(e),_(!1)}),1e3)}else h(null)})()}catch(a){t((e=>[...e,{sender:"ai",text:"I had difficulties analyzing your response, please re-send it."}])),_(!1)}},q=a=>{var n,s;if(a.shiftKey&&"Enter"===a.key){a.preventDefault();var i=a.target.selectionStart,o=a.target.selectionEnd,c=a.target.value;a.target.value=c.substring(0,i)+"\n"+c.substring(o),a.target.selectionStart=a.target.selectionEnd=i+1}if("Enter"===a.key&&!a.shiftKey||"1"===(null===(n=a.currentTarget)||void 0===n||null===(s=n.dataset)||void 0===s?void 0:s.send)){a.preventDefault();const n=r.trim();n.replace(/(\r\n|\n|\r)+/gm,"").trim().length>0&&(t([...e,{sender:"user",text:n}]),S(n),d(""))}},I=(0,a.useCallback)((e=>{_(!0),setTimeout((()=>{t((e=>[...e,{sender:"ai",text:"Welcome to the ".concat(y.text," interview. During this session, I will ask you five technical questions. Please respond to each question to the best of your ability. At the end of the interview, I will provide you with your final grade. Let's get started with the first question:")}]))}),1e3),setTimeout((()=>{t((t=>[...t,{sender:"ai",text:"".concat(e.question)}])),h(e),_(!1)}),2e3)}),[y]),T=(0,a.useCallback)((async()=>{try{if(null!==y&&void 0!==y&&y.id){_(!0);const e=await(async e=>{const t={method:"GET",url:"".concat(o,"/InterviewQuestions/").concat(e),...c};try{const e=(0,s.A)(t);if(!e)throw new Error("No response from requestInterviewGrading");return e}catch(r){Promise.reject(r)}})(y.id),t=e.data,r=t.pop();I(r),v(t),_(!1)}}catch(e){_(!1),i.oR.error("Error fetching interview questions. Please try again")}}),[y,I]);return(0,a.useEffect)((()=>{T()}),[T]),(0,a.useEffect)((()=>{b({...j})}),[j]),(0,a.useEffect)((()=>{E&&k()}),[k,E]),(0,a.useEffect)((()=>{N.current&&(N.current.scrollTop=N.current.scrollHeight)}),[e]),(0,l.jsxs)("div",{className:"new-interview__root",children:[(0,l.jsxs)("h1",{className:"new-interview__header",children:[null===y||void 0===y?void 0:y.text," Interview"]}),(0,l.jsxs)("div",{className:"new-interview__chatbox-container",children:[" ",(0,l.jsxs)("div",{className:"new-interview__chatbox",ref:N,children:[e.map(((e,t)=>(0,l.jsx)("div",{className:"new-interview__message new-interview__message--".concat(e.sender),children:(0,l.jsx)("div",{className:"new-interview__message-box new-interview__message-box--".concat(e.sender),children:e.text})},t))),m&&(0,l.jsx)("div",{className:"react-interview__message react-interview__message--ai",children:(0,l.jsx)("div",{className:"react-interview__loader",children:(0,l.jsxs)("div",{className:"react-interview__loader-dots",children:[(0,l.jsx)("div",{className:"react-interview__loader-dot"}),(0,l.jsx)("div",{className:"react-interview__loader-dot"}),(0,l.jsx)("div",{className:"react-interview__loader-dot"})]})})})]}),(0,l.jsxs)("div",{className:"new-interview__input",children:[(0,l.jsx)("textarea",{value:r,onChange:e=>{d(e.target.value)},onKeyDown:q,rows:"3",placeholder:"Type your answer...",disabled:m||x,autoCorrect:"on"}),(0,l.jsx)("button",{onClick:q,"data-send":"1",disabled:m||x,children:"Send"})]})]})]})}},220:()=>{}}]);
//# sourceMappingURL=528.bd41fbd4.chunk.js.map